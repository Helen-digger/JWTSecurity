# Домашнее задание по курсу открытой школы "Холдинг Т1"
## Реализация аутентификации и авторизации с использованием Spring Security и JWT

### Что было сделано
1. Написан проект с использованием Spring Security и собственной аутентификацией и авторизацией на основе JWT. Работает через собственный AuthenticationProvider с AuthenticationFilter и AuthenticationConverter. Возможно добавление других типов аутентификации через AuthenticationProvider.
2. Описана модель данных, пользователи хранятся в PostgreSQL, refresh токены хранятся в In-Memory кэше на основе Google Guava Cache.
3. Добавлен контроллер для создания пользователей, для аутентификации, получения JWT токена и для обновления токена.
4. Добавлен контроллер для действий с ролью ADMIN и действий с ролью USER.
5. Написаны модульные тесты с использованием SpringBootTest и TestContainers. В тестах проверяется работа сервисов, а также работа аутентификации и авторизации на защищенных контроллерах.
6. Добавлен swagger-ui для описания контрактов API.

### How-to
1. Для того чтобы поднять сервис требуется наличие Java 17 и Docker на целевой системе.
2. Убедиться, что порт 8080 доступен и не занят другими сервисами. Порт можно сменить в `application.properties`.
3. Выполнить команду ```./gradlew bootRun``` в командной строке
4. Перейти в браузере по адресу `http://localhost:8080/swagger-ui`
5. С помощью swagger-ui создать пользователя с соотвестующей ролью через `/api/v1/public/user`
6. Получить токен по имени пользователя и паролю на `/api/v1/public/token/password`.
7. Проверить работу refresh с помощью `/api/v1/public/token/refresh`.
8. С помощью swagger-ui выполнить метод `/admin` и `/user`. Для этого используем JWT токен полученный на шаге выше, через "замочек" на ручке указываем наш токен. Убедиться, что в зависимости от типа токена, либо при его отсутсвтии мы получем статусы 200(аутентифицирован и авторизован), 403(аутентифицирован и не авторизован) и 401 (не аутентифицирован и не авторизован).
9. Тесты можно запустить с помощью команды ```./gradlew test```